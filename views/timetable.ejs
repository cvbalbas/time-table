<!DOCTYPE html>
<html>
<head>
	<!--import Boostrap plugin-->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

	<style>
		body {
			background-color: ghostwhite;
		}
		table {
			border:  1px solid white;
			/*border-collapse: collapse;	/*no borders*/
			width: 1500px;
			margin-left: auto;
	  		margin-right: auto;
	  		font-family: "Gill Sans", sans-serif;
	  		z-index: 1;				/*table is over the highlight*/
	  		overflow: hidden;		/*cuts off the column highlight as to not overflow*/
	  		border-radius: 20px;
	  		box-shadow: 5px 10px 50px rgba(0, 0, 0, 0.25);
		}

		h2 {
			width: 1500px;
			margin-left: auto;
	  		margin-right: auto;
	  		font-family: "Gill Sans", sans-serif;
		}

		td, th {
			cursor: pointer;
			padding: 20px;
			position: relative;
			text-align: center;
			width: 12.5%;
		}

		th {
			background-color: #354863 !important;
			color: #FFFFFF;
			text-transform: uppercase;
		}

		.button {					/*format of + buttons*/
			border: none;
			color: blue;
			padding: 1px 2px;
			text-align: center;
			font-size: 12px;
			margin: 1px 1px;
			cursor: pointer;
			float: right;
		}

		/* .buttonalign {	/*puts the button on the rightmost of the cell
			text-align: right;		
		} */

		tr:hover {					/*highlights rows*/
			background-color: rgba(195, 164, 255, 0.25);
			z-index: -1;
		}

		td:hover::after { 			/*highlights columns*/
		    background-color: rgba(195, 164, 255, 0.25);
		    content: "";
		    height: 10000px;    
		    left: 0;
		    position: absolute;  
		    top: -5000px;
		    width: 100%;
		    z-index: -1;
		}
		.chevron {
			margin-left: auto;
	  		margin-right: 0;
	  		font-family: "Gill Sans", sans-serif;
		}
	</style>
</head>

<body onload="addButtons()">
    <!-- Left and right controls -->
    <div class="chevron">
	    <a href="#myCarousel" data-slide="prev">
	    	<span class="glyphicon glyphicon-chevron-left"></span>
	    	<span class="sr-only">Previous</span>
	    </a>
	    <a href="#myCarousel" data-slide="next">
	    	<span class="glyphicon glyphicon-chevron-right"></span>
	    	<span class="sr-only">Next</span>
	    </a>
	</div>
	<!--start of carousel-->
	<div id="myCarousel" class="carousel slide" data-interval="false">
	    <div class="carousel-inner">
	      	<div class="item active">
		        <h2>Timetable</h2>
				<table>
					<tr>
						<th>Time</th>
						<th>Monday</th>
						<th>Tuesday</th>
						<th>Wednesday</th>
						<th>Thursday</th>
						<th>Friday</th>
						<th>Saturday</th>
						<th>Sunday</th>
					</tr>

					<tr>
						<th>0900-1000</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1000-1100</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1100-1200</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1200-1300</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1300-1400</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1400-1500</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1500-1600</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1600-1700</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1700-1800</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1800-1900</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>1900-2000</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<th>2000-2100</th>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
					</tr>
				</table>
	      	</br></br></br>
	      	</div>
	      	
	      	<div class="item">
		      	<h2>This Week</h2>
				<table>
					<tr>
						<th>Time</th>
						<th class = "monday">Monday</th>
						<th class = "tuesday">Tuesday</th>
						<th class = "wednesday">Wednesday</th>
						<th class = "thursday">Thursday</th>
						<th class = "friday">Friday</th>
						<th class = "saturday">Saturday</th>
						<th class = "sunday">Sunday</th>
					</tr>

					<tr>
						<th>0900-1000</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>		
					</tr>

					<tr>
						<th>1000-1100</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1100-1200</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1200-1300</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1300-1400</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1400-1500</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1500-1600</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1600-1700</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1700-1800</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1800-1900</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>1900-2000</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>

					<tr>
						<th>2000-2100</th>
						<td class = "monday"></td>			
						<td class = "tuesday"></td>		
						<td class = "wednesday"></td>		
						<td class = "thursday"></td>		
						<td class = "friday"></td>			
						<td class = "saturday"></td>		
						<td class = "sunday"></td>	
					</tr>
				</table>
	      	</br></br></br>
	      	</div>
	    	

	    	<div class="item">
		        <h2>Next Week</h2>
				<table>
					<tr>
						<th>Time</th>
						<th>Monday</th>
						<th>Tuesday</th>
						<th>Wednesday</th>
						<th>Thursday</th>
						<th>Friday</th>
						<th>Saturday</th>
						<th>Sunday</th>
					</tr>

					<tr>
						<th>0900-1000</th>
						<td></td>			<!--Monday-->
						<td></td>			<!--Tuesday-->
						<td></td>			<!--Wednesday-->
						<td></td>			<!--Thursday-->
						<td></td>			<!--Friday-->
						<td></td>			<!--Saturday-->
						<td></td>			<!--Sunday-->
					</tr>

					<tr>
						<th>1000-1100</th>
						<td></td>			<!--Monday-->
						<td></td>			<!--Tuesday-->
						<td></td>			<!--Wednesday-->
						<td></td>			<!--Thursday-->
						<td></td>			<!--Friday-->
						<td></td>			<!--Saturday-->
						<td></td>			<!--Sunday-->
					</tr>

					<tr>
						<th>1100-1200</th>
						<td></td>			<!--Monday-->
						<td></td>			<!--Tuesday-->
						<td></td>			<!--Wednesday-->
						<td></td>			<!--Thursday-->
						<td></td>			<!--Friday-->
						<td></td>			<!--Saturday-->
						<td></td>			<!--Sunday-->
					</tr>

					<tr>
						<th>1200-1300</th>
						<td></td>			<!--Monday-->
						<td></td>			<!--Tuesday-->
						<td></td>			<!--Wednesday-->
						<td></td>			<!--Thursday-->
						<td></td>			<!--Friday-->
						<td></td>			<!--Saturday-->
						<td></td>			<!--Sunday-->
					</tr>

					<tr>
						<th>1300-1400</th>
						<td></td>			<!--Monday-->
						<td></td>			<!--Tuesday-->
						<td></td>			<!--Wednesday-->
						<td></td>			<!--Thursday-->
						<td></td>			<!--Friday-->
						<td></td>			<!--Saturday-->
						<td></td>			<!--Sunday-->
					</tr>

					<tr>
						<th>1400-1500</th>
						<td></td>			<!--Monday-->
						<td></td>			<!--Tuesday-->
						<td></td>			<!--Wednesday-->
						<td></td>			<!--Thursday-->
						<td></td>			<!--Friday-->
						<td></td>			<!--Saturday-->
						<td></td>			<!--Sunday-->
					</tr>

					<tr>
						<th>1500-1600</th>
						<td></td>			<!--Monday-->
						<td></td>			<!--Tuesday-->
						<td></td>			<!--Wednesday-->
						<td></td>			<!--Thursday-->
						<td></td>			<!--Friday-->
						<td></td>			<!--Saturday-->
						<td></td>			<!--Sunday-->
					</tr>

					<tr>
						<th>1600-1700</th>
						<td></td>		<!--Monday-->
						<td></td>		<!--Tuesday-->
						<td></td>		<!--Wednesday-->
						<td></td>		<!--Thursday-->
						<td></td>		<!--Friday-->
						<td></td>		<!--Saturday-->
						<td></td>		<!--Sunday-->
					</tr>

					<tr>
						<th>1700-1800</th>
						<td></td>		<!--Monday-->
						<td></td>		<!--Tuesday-->
						<td></td>		<!--Wednesday-->
						<td></td>		<!--Thursday-->
						<td></td>		<!--Friday-->
						<td></td>		<!--Saturday-->
						<td></td>		<!--Sunday-->
					</tr>

					<tr>
						<th>1800-1900</th>
						<td></td>		<!--Monday-->
						<td></td>		<!--Tuesday-->
						<td></td>		<!--Wednesday-->
						<td></td>		<!--Thursday-->
						<td></td>		<!--Friday-->
						<td></td>		<!--Saturday-->
						<td></td>		<!--Sunday-->
					</tr>

					<tr>
						<th>1900-2000</th>
						<td></td>		<!--Monday-->
						<td></td>		<!--Tuesday-->
						<td></td>		<!--Wednesday-->
						<td></td>		<!--Thursday-->
						<td></td>		<!--Friday-->
						<td></td>		<!--Saturday-->
						<td></td>		<!--Sunday-->
					</tr>

					<tr>
						<th>2000-2100</th>
						<td></td>		<!--Monday-->
						<td></td>		<!--Tuesday-->
						<td></td>		<!--Wednesday-->
						<td></td>		<!--Thursday-->
						<td></td>		<!--Friday-->
						<td></td>		<!--Saturday-->
						<td></td>		<!--Sunday-->
					</tr>
				</table>
	   		</br></br></br>
	   		</div>
	  	</div>
	</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/web-socket-js/1.0.0/web_socket.min.js" integrity="sha512-jtr9/t8rtBf1Sv832XjG1kAtUECQCqFnTAJWccL8CSC82VGzkPPih8rjtOfiiRKgqLXpLA1H/uQ/nq2bkHGWTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
	function addButtons(){				//add buttons and unique btn ID for each using a for loop instead of copy paste within html
		var tds = document.getElementsByTagName("td");

		for ( var index = 0; index < tds.length; index++) {

            var data = <%- JSON.stringify(data) %>;
            console.log(data)

			tds[index].innerHTML = '<div id="c' + index + '">'+data[0]["c"+index.toString()]+'</div>' + tds[index].innerHTML + '<div class="buttonalign";><button id="' + index + '" class="button" onclick="SetCell(this)">+</button></div>';
		}
	}

    function SetCell(btn) {				//when button is clicked, a prompt shows asking for a name to add.
        let cellname = "c" + btn.id;
        let text;
        let person = prompt("Please enter name:");
        if (person == null || person == "") {
            text = '';
        }
        else {
            text = person ;
        }
        document.getElementById(cellname).innerHTML = text;		//Saves it to the cell# that triggered the function.

        $.ajax({
            type: 'POST',
            url: 'http://localhost:3000/updateTimetableTable',
            data: { 'student': text, 'cell': cellname },
            success: sendRefreshMessageToServer()
        });

    }


	let date = new Date();					//gets current day
	let dayofweeknumber = date.getDay();
	let nameOfDay;

	switch(dayofweeknumber) {
		case 0: 
        	nameOfDay = 'sunday';
        	break;

   		case 1:
        	nameOfDay = 'monday';
        	break;

    	case 2:
        	nameOfDay = 'tuesday';
        	break;

    	case 3:
        	nameOfDay = 'wednesday';
        	break;

    	case 4:
        	nameOfDay = 'thursday';
        	break;

    	case 5:
        	nameOfDay = 'friday';
        	break;

    	case 6:
        	nameOfDay = 'saturday';
        	break;
	}

	for (var i = 0; i < 13; i++) {		//highlights current day in second table
		document.getElementsByClassName(nameOfDay)[i].style.backgroundColor = "rgba(195, 164, 255, 0.5)";
	}

    const url = 'ws://localhost:8080'
    const connection = new WebSocket(url)

    connection.onmessage = (e) => {
        if (e.data != clientId.toString()) {
            location.reload()
        } else {
            console.log(e.data)
        }
    }


    var clientId = Math.random(1)

    function sendRefreshMessageToServer() {
        connection.send(clientId)
    }

</script> 

</body>
</html>